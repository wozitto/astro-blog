---
import { getCollection } from "astro:content";
import Posts from "@layouts/Posts.astro";
import getPagination from "@utils/getPagination";
import feedPosts from "../../content/feeds/posts.json";
import sortCombinedPosts from "@utils/sortCombinedPosts";

const markdownPosts = await getCollection("blog");

const combinedPosts = [
  ...markdownPosts.map(post => ({
    ...post.data,
    slug: post.slug,
    type: "post",
  })),
  ...feedPosts.map(feedPost => ({
    ...feedPost,
    type: "feedPost",
  })),
];

const sortedCombinedPosts = sortCombinedPosts(combinedPosts);

const pagination = getPagination({
  posts: sortedCombinedPosts,
  page: 1,
  isIndex: true,
});
---

<Posts {...pagination} />
